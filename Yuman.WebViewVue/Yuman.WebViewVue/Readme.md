# 系统搭建流程
## 1.WebView2（WinForm程序）
NuGet包引入WebView2，将WebView2控件挂到Form1，然后建立index.html，WebView2来源指定这个静态页面

## 2.引入平时开发常用的类库、组件
建立_lib、_pages文件夹，将常用的组件类库加入进来，并在index.html页面引入

## 3.封装导航栏和分页加载
引入handlebars.js，将页面渲染参数配置化，然后其他分页通过后端读取本地文件的方式，用字符串返回给前端进行动态拼接；
每个分页单独初始化vue，切换菜单时就进行初始化操作

## 4.引入依赖注入，实现动态反射注入
引入Microsoft.Extensions.DependencyInjection类库，对窗体应用实现依赖注入，建立3种接口，瞬态/作用域/单例，分别对继续了这3种接口的实现对应注入

## 5.封装一套前后端请求，符合ajax的使用习惯
5.1.最开始是使用WebView2自带的PostMessage的方式，前端发消息后端接收，后端发消息前端接口的方式，然后发现这种方式要自己实现回调等待一系列问题，可以实现但是太麻烦
5.2.接着是了解到WebView2有HostObjects的通讯方式，不过发现这种方式后端接口传入和传出都是字符串比较好用，如果是复杂类型就很难用
5.3.在5.2的基础上后端所有的接口都按照传入传出都是字符串的类型，然后每个方法里面自己去序列化和反序列化，但是这样太麻烦了
5.4.在5.2和5.3的基础上再优化，固定一个HostObjects接口，传入传出都是字符串类型，然后自己反射需要提供接口的类，然后固定生成一套js给前端调用，然后后端接口方法也使用反射去实例化方法执行
最终实现了一套整齐的接口调用，符合传统的ajax的调用习惯

# 开发流程
## 1.在_index.js里面配菜单名称
## 2.在_pages创建页面、js、css
## 3.在index.html引入js和css
## 4.在Services实现后端接口
## 5.在Managers实现业务逻辑，给接口调用

# 开发注意的一些原则
## 1.链接数据库等底层操作，只在Managers里面进行，Services只对外开发接口，不要在这里依赖数据库查询，以后可能更换数据库，只需要重写Manager服务即可

# 后续升级
## 1.支持多语言

# 项目结构
## 1.index.html，_lib， _pages 这3个是前端相关文件
## 2.Services是后端接口，将实体转dto，对前端开放接口
## 3.Managers是后端服务，核心业务逻辑
## 4.Hepler是帮助类

# 额外遇到的问题与解决方案
1.读取html文件中文乱码，引入System.Text.Encoding.CodePages包，注册并使用GB2312读取文件即可